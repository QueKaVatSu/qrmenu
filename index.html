<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spicy Menu</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React Kütüphaneleri -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <!-- Babel (JSX'i tarayıcıda çalıştırmak için) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        /* Poppins Font */
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap');
        body { font-family: 'Poppins', sans-serif; }
        .font-regular { font-weight: 400; }
        .font-medium { font-weight: 500; }
        .font-semibold { font-weight: 600; }
        /* Scrollbar Gizleme */
        .scroll-hidden::-webkit-scrollbar { display: none; }
        .scroll-hidden { -ms-overflow-style: none; scrollbar-width: none; }
        
        /* Logo için özel animasyon */
        @keyframes pulse-scale {
          0%, 100% {
            transform: scale(1);
            opacity: 0.95;
          }
          50% {
            transform: scale(1.03);
            opacity: 1;
          }
        }
        .animate-pulse-scale {
          animation: pulse-scale 2.5s ease-in-out infinite;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        // --- Ikonlar (SVG olarak) ---
        const MenuIcon = () => (
          <svg xmlns="http://www.w3.org/2000/svg" className="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}>
            <path strokeLinecap="round" strokeLinejoin="round" d="M4 6h16M4 12h16m-16 6h16" />
          </svg>
        );

        const SearchIcon = () => (
          <svg xmlns="http://www.w3.org/2000/svg" className="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}>
            <path strokeLinecap="round" strokeLinejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
          </svg>
        );

        const BackIcon = ({ className = "h-5 w-5" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" className={className} fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}>
                <path strokeLinecap="round" strokeLinejoin="round" d="M15 19l-7-7 7-7" />
            </svg>
        );
        
        const ClockIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" className="h-6 w-6 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}>
                <path strokeLinecap="round" strokeLinejoin="round" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
        );

        const WeightIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" className="h-6 w-6 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}>
                 <path strokeLinecap="round" strokeLinejoin="round" d="M3 6l3 1m0 0l-3 9a5.002 5.002 0 006.001 0M6 7l3 9M6 7l6-2m6 2l3-1m-3 1l-3 9a5.002 5.002 0 006.001 0M18 7l3 9m-3-9l-6-2m0-2v2m0 16V5m0 16H9m3 0h3" />
            </svg>
        );

        const FireIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" className="h-6 w-6 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}>
                <path strokeLinecap="round" strokeLinejoin="round" d="M17.657 18.657A8 8 0 016.343 7.343S7 9 9 10c0-2 .5-5 2.986-7.014A8.003 8.003 0 0112 2a8.003 8.003 0 016.014 2.986C20.5 5 21 8 21 10c2 1 2.657 2.343 2.657 2.657a8 8 0 01-11.314 6z" />
            </svg>
        );
        
        const throttle = (func, limit) => {
          let inThrottle;
          return function() {
            const args = arguments;
            const context = this;
            if (!inThrottle) {
              func.apply(context, args);
              inThrottle = true;
              setTimeout(() => (inThrottle = false), limit);
            }
          };
        };

        const menuData = {
          categoryRows: [
            [{ id: 'c1', name: 'Ara Sıcaklar', subtitle: 'Lezzetli bir başlangıç', width: 170, height: 200, media: 'title1' },{ id: 'c2', name: 'İçecekler', subtitle: 'Taze ve serinletici', width: 170, height: 200, media: 'title2' }],
            [{ id: 'c3', name: 'Pizza', subtitle: 'Ekşi maya hamurdan gelen lezzet', width: 205, height: 250, media: 'title3' },{ id: 'c4', name: 'Salatalar', subtitle: 'Her zaman taze', width: 135, height: 200, media: 'title4' }],
            [{ id: 'c5', name: 'Ana Yemekler', subtitle: 'Şef seçkisi lezzetler', width: 360, height: 200, media: 'title5' }],
            [{ id: 'c6', name: 'Şaraplar', subtitle: 'Bağlardan kristal kadehlere', width: 205, height: 250, media: 'title6' },{ id: 'c7', name: 'Tatlılar', subtitle: 'Mutluluk Tadında Lezzetler', width: 135, height: 200, media: 'title7' }],
            [{ id: 'c8', name: 'Rakılar', subtitle: 'Muhabbetin Dem Vakti', width: 170, height: 200, media: 'title8' },{ id: 'c9', name: 'Biralar', subtitle: 'Köpüklü, Soğuk, Lezzetli', width: 170, height: 200, media: 'title9' }],
            [{ id: 'c10', name: 'Mezeler', subtitle: 'Sofranın Bütün Renkleri', width: 205, height: 250, media: 'title10' },{ id: 'c11', name: 'Shots', subtitle: 'Hızlı, Cesur, Unutulmaz', width: 135, height: 200, media: 'title11' }]
          ],
          products: {
            'c1': [
                { id: 'p1-1', name: 'Paçanga Böreği', description: 'Pastırmalı, domatesli, biberli', price: '250 TL', image: 'https://placehold.co/200x200/e9e9e9/333?text=Paçanga', video: 'arasicak1' },
                { id: 'p1-2', name: 'İçli Köfte', description: 'Kızartılmış, cevizli, kıymalı', price: '200 TL', image: 'https://placehold.co/200x200/e9e9e9/333?text=İçli+Köfte', video: 'arasicak2' },
                { id: 'p1-3', name: 'Karides Güveç', description: 'Tereyağında, sarımsaklı, mantarlı', price: '500 TL', image: 'https://placehold.co/200x200/e9e9e9/333?text=Karides', video: 'arasicak3' },
                { id: 'p1-4', name: 'Kalamar Tava', description: 'Tarator sos ile', price: '450 TL', image: 'https://placehold.co/200x200/e9e9e9/333?text=Kalamar', video: 'arasicak4' }
            ],
            'c2': [ 
                { id: 'p2', name: 'Limonata', description: 'Ev yapımı, taze nane ile.', price: '90 TL', image: 'https://placehold.co/600x400/e9e9e9/333?text=Limonata', tags: ['icecek', 'alkolsuz'] },
                { id: 'p2-2', name: 'Kola', description: 'Buz gibi.', price: '70 TL', image: 'https://placehold.co/600x400/e9e9e9/333?text=Kola', tags: ['icecek', 'alkolsuz', 'kola'] }
            ],
            'c3': [ { id: 'p3', name: 'Margarita Pizza', description: 'Domates sos, mozzarella ve taze fesleğen.', price: '250 TL', image: 'https://placehold.co/600x400/e9e9e9/333?text=Pizza', tags: ['pizza'] } ],
            'c4': [
                { id: 'p4-1', name: 'Akdeniz Salata', description: 'Taze yeşillikler ile', price: '250 TL', image: 'https://placehold.co/200x200/e9e9e9/333?text=Salata', video: 'salata1', tags: ['salata'] },
                { id: 'p4-2', name: 'Sezar Salata', description: 'Izgara tavuk ve kruton ile', price: '280 TL', image: 'https://placehold.co/200x200/e9e9e9/333?text=Sezar', video: 'salata2', tags: ['salata'] },
                { id: 'p4-3', name: 'Gavurdağı Salata', description: 'Cevizli ve nar ekşili', price: '200 TL', image: 'https://placehold.co/200x200/e9e9e9/333?text=Gavurdağı', video: 'salata3', tags: ['salata'] },
                { id: 'p4-4', name: 'Bonfile Salata', description: 'Dilimlenmiş bonfile parçaları ile', price: '400 TL', image: 'https://placehold.co/200x200/e9e9e9/333?text=Bonfile+Salata', video: 'salata4', tags: ['salata'] }
            ],
            'c5': [
                { id: 'p5-1', name: 'Trüf Burger', description: 'Trüf mayonez ve cheddar peyniri ile', price: '780 TL', image: 'https://placehold.co/150x150/e9e9e9/333?text=Burger', video: 'product1', prepTime: 20, grams: 450, kcal: 900, tags: ['kirmizi-et', 'burger'] },
                { id: 'p5-2', name: 'Kuzu Pirzola', description: 'Izgara sebzeler ve firik pilavı ile', price: '950 TL', image: 'https://placehold.co/150x150/e9e9e9/333?text=Pirzola', video: 'product2', prepTime: 30, grams: 450, kcal: 950, tags: ['kirmizi-et'] },
                { id: 'p5-3', name: 'Izgara Somon', description: 'Kuşkonmaz ve avokado salatası ile', price: '750 TL', image: 'https://placehold.co/150x150/e9e9e9/333?text=Somon', video: 'product3', prepTime: 20, grams: 350, kcal: 650, tags: ['balik'] },
                { id: 'p5-4', name: 'T-Bone Steak', description: '600gr, özel baharatlarla marine edilmiş', price: '1250 TL', image: 'https://placehold.co/150x150/e9e9e9/333?text=Steak', video: 'product4', prepTime: 35, grams: 600, kcal: 1200, tags: ['kirmizi-et', 'steak'] },
                { id: 'p5-5', name: 'Smash Burger', description: 'Karamelize soğan ve özel sos ile', price: '680 TL', image: 'https://placehold.co/150x150/e9e9e9/333?text=Smash', video: 'product5', prepTime: 15, grams: 350, kcal: 850, tags: ['kirmizi-et', 'burger'] },
                { id: 'p5-6', name: 'Antrikot', description: '250gr, dinlendirilmiş dana antrikot', price: '1100 TL', image: 'https://placehold.co/150x150/e9e9e9/333?text=Antrikot', video: 'product6', prepTime: 30, grams: 250, kcal: 850, tags: ['kirmizi-et', 'steak'] },
                { id: 'p5-7', name: 'Kuzu İncik', description: 'Ağır ateşte pişirilmiş, tandır lezzeti', price: '980 TL', image: 'https://placehold.co/150x150/e9e9e9/333?text=İncik', video: 'product7', prepTime: 180, grams: 550, kcal: 1100, tags: ['kirmizi-et'] },
            ],
             'c6': [
                { id: 'p6-1', name: 'Kavaklıdere Ancyra Blush', description: '75cl', price: '1,250 TL', image: 'https://placehold.co/200x200/e9e9e9/333?text=Şarap', video: 'sarap1' },
                { id: 'p6-2', name: 'Kavaklıdere Ancyra Merlot', description: '75cl', price: '1,250 TL', image: 'https://placehold.co/200x200/e9e9e9/333?text=Şarap', video: 'sarap2' },
                { id: 'p6-3', name: 'Kavaklıdere Lal', description: '75cl', price: '1,350 TL', image: 'https://placehold.co/200x200/e9e9e9/333?text=Şarap', video: 'sarap3' },
                { id: 'p6-4', name: 'Kavaklıdere Selection', description: '75cl', price: '1,750 TL', image: 'https://placehold.co/200x200/e9e9e9/333?text=Şarap', video: 'sarap4' },
                { id: 'p6-5', name: 'Suvla Reserve', description: '75cl', price: '1,500 TL', image: 'https://placehold.co/200x200/e9e9e9/333?text=Şarap', video: 'sarap5' },
            ],
            'c7': [
                { id: 'p7-1', name: 'San Sebastian Cheesecake', description: 'Kremalı ve akışkan', price: '300 TL', image: 'https://placehold.co/200x200/e9e9e9/333?text=Cheesecake', video: 'tatli1' },
                { id: 'p7-2', name: 'Çikolatalı Sufle', description: 'Sıcak ve akışkan çikolata', price: '250 TL', image: 'https://placehold.co/200x200/e9e9e9/333?text=Sufle', video: 'tatli2' },
                { id: 'p7-3', name: 'Meyve Tabağı', description: 'Mevsimin taze meyveleri', price: '400 TL', image: 'https://placehold.co/200x200/e9e9e9/333?text=Meyve', video: 'tatli3' },
                { id: 'p7-4', name: 'Tiramisu', description: 'İtalyan klasiği', price: '280 TL', image: 'https://placehold.co/200x200/e9e9e9/333?text=Tiramisu', video: 'tatli4' }
            ],
            'c8': [
                { id: 'p8-1', name: 'Yeşil Efe', description: '50cl', price: '1,300 TL', image: 'https://placehold.co/200x200/e9e9e9/333?text=Rakı', video: 'raki1' },
                { id: 'p8-2', name: 'Efe Gold', description: '70cl', price: '1,800 TL', image: 'https://placehold.co/200x200/e9e9e9/333?text=Rakı', video: 'raki2' },
                { id: 'p8-3', name: 'Beylerbeyi Göbek', description: '70cl', price: '2,200 TL', image: 'https://placehold.co/200x200/e9e9e9/333?text=Rakı', video: 'raki3' },
                { id: 'p8-4', name: 'Yeni Rakı Ala', description: '70cl', price: '2,000 TL', image: 'https://placehold.co/200x200/e9e9e9/333?text=Rakı', video: 'raki4' }
            ],
            'c9': [
                { id: 'p9-1', name: 'Efes Pilsen', description: '50cl', price: '200 TL', image: 'https://placehold.co/200x200/e9e9e9/333?text=Bira', video: 'bira1' },
                { id: 'p9-2', name: 'Efes Malt', description: '50cl', price: '200 TL', image: 'https://placehold.co/200x200/e9e9e9/333?text=Bira', video: 'bira2' },
                { id: 'p9-3', name: 'Bomonti Filtresiz', description: '50cl', price: '220 TL', image: 'https://placehold.co/200x200/e9e9e9/333?text=Bira', video: 'bira3' },
                { id: 'p9-4', name: 'Carlsberg', description: '50cl', price: '220 TL', image: 'https://placehold.co/200x200/e9e9e9/333?text=Bira', video: 'bira4' },
                { id: 'p9-5', name: 'Corona', description: '33cl', price: '250 TL', image: 'https://placehold.co/200x200/e9e9e9/333?text=Bira', video: 'bira5' }
            ],
            'c10': [
                { id: 'p10-1', name: 'Atom', description: 'Süzme yoğurt, acı biber', price: '150 TL', image: 'https://placehold.co/200x200/e9e9e9/333?text=Meze', video: 'meze1' },
                { id: 'p10-2', name: 'Muhammara', description: 'Ceviz, biber salçası', price: '170 TL', image: 'https://placehold.co/200x200/e9e9e9/333?text=Meze', video: 'meze2' },
                { id: 'p10-3', name: 'Peynir Tabağı', description: 'Seçme yerli ve ithal peynirler', price: '450 TL', image: 'https://placehold.co/200x200/e9e9e9/333?text=Peynir', video: 'meze3' },
                { id: 'p10-4', name: 'Humus', description: 'Nohut, tahin, zeytinyağı', price: '150 TL', image: 'https://placehold.co/200x200/e9e9e9/333?text=Meze', video: 'meze4' },
                { id: 'p10-5', name: 'Babagannuş', description: 'Közlenmiş patlıcan, yoğurt', price: '170 TL', image: 'https://placehold.co/200x200/e9e9e9/333?text=Meze', video: 'meze5' },
                { id: 'p10-6', name: 'Haydari', description: 'Yoğurt, nane, sarımsak', price: '150 TL', image: 'https://placehold.co/200x200/e9e9e9/333?text=Meze', video: 'meze6' },
                { id: 'p10-7', name: 'Acılı Ezme', description: 'Domates, biber, soğan', price: '150 TL', image: 'https://placehold.co/200x200/e9e9e9/333?text=Meze', video: 'meze7' }
            ],
            'c11': [
                 { id: 'p11-1', name: 'Tekila', description: '', price: '200 TL', image: 'https://placehold.co/200x200/e9e9e9/333?text=Tekila', video: 'shot1' },
                 { id: 'p11-2', name: 'Jager', description: '', price: '200 TL', image: 'https://placehold.co/200x200/e9e9e9/333?text=Jager', video: 'shot2' },
                 { id: 'p11-3', name: 'B52', description: '', price: '250 TL', image: 'https://placehold.co/200x200/e9e9e9/333?text=B52', video: 'shot3' }
            ],
          },
          stories: {
            'c1': {
                title: 'Ara Sıcakların Hikayesi',
                summary: 'Yemeğe lezzetli bir başlangıç yapmak için, her biri özenle hazırlanan sıcak atıştırmalıklarımızı keşfedin. Geleneksel tatlar, modern dokunuşlarla buluşuyor.',
                fullStory: 'Sofralarımızın vazgeçilmezi ara sıcaklar, ana yemeğe giden yolda lezzetli bir mola sunar. Paçanga böreğimizin çıtırtısından, güvecimizde pişen karidesin tereyağlı kokusuna kadar her bir lezzet, en taze malzemelerle ve ustalıkla hazırlanır. Bu küçük tabaklar, büyük mutluluklar vaat ediyor.',
                image: 'https://placehold.co/600x400/333/fff?text=Ara+Sıcaklar'
            },
            'c4': {
                title: 'Salataların Hikayesi',
                summary: 'Doğanın en taze yeşillikleri, şefimizin özel dokunuşlarıyla sağlıklı ve lezzetli tabaklara dönüşüyor. Her bir salata, ferahlatıcı bir öğün vaat ediyor.',
                fullStory: 'Ferahlık ve lezzetin mükemmel birleşimi olan salatalarımız, en taze mevsim yeşillikleri ve kaliteli malzemelerle hazırlanır. İster hafif bir başlangıç, ister doyurucu bir ana öğün olsun, her tabağımızda doğanın renklerini ve tazeliğini bulacaksınız.',
                image: 'https://placehold.co/600x400/333/fff?text=Salatalar'
            },
            'c5': {
                title: 'Trüf Burgerin Hikayesi',
                summary: 'Mevsimin en taze trüfleri, dinlendirilmiş dana köftesi ve özel brioche ekmeğiyle buluşuyor. Bu burger, sıradan bir lezzetin ötesinde unutulmaz bir deneyim vaat ediyor.',
                fullStory: `Her şey, ormanın derinliklerinden gelen o eşsiz aroma ile başladı. Şeflerimiz, mevsimin en kaliteli siyah trüf mantarlarını bulmak için uzun bir yolculuğa çıktı. Bu nadide lezzeti, 28 gün boyunca dinlendirilmiş, %100 dana etinden hazırlanan 200 gramlık özel köftemizle buluşturduk. \n\nKöftenin mükemmel lezzetini tamamlamak için, her gün kendi fırınımızda pişirdiğimiz, tereyağlı ve hafif tatlı brioche ekmeğini kullanıyoruz. Erimiş cheddar peynirinin zenginliği ve ev yapımı trüflü mayonezimizin kremsi dokunuşu, bu burgeri bir sanat eserine dönüştürüyor. Yanında servis ettiğimiz baharatlı patates kızartması ile bu lezzet şölenini tamamlıyoruz.`,
                image: 'https://placehold.co/600x400/333/fff?text=Trüf+Hikayesi'
            },
            'c6': {
                title: 'Şarapların Hikayesi',
                summary: 'Anadolu ve dünya bağlarının en seçkin üzümlerinden üretilen şarap seçkimiz, yemeğinizin lezzetini tamamlamak için sizi bekliyor. Her damlasında toprağın ve emeğin izlerini taşıyan bir yolculuk.',
                fullStory: 'Bir kadeh şarap, bir yemeği unutulmaz bir anıya dönüştürebilir. Kırmızı, beyaz veya roze... Her biri farklı bir karakter, farklı bir hikaye anlatır. Kavımızdaki her bir şişe, yemeğinizle mükemmel bir uyum yakalamak ve damak zevkinize hitap etmek için özenle seçilmiştir.',
                image: 'https://placehold.co/600x400/333/fff?text=Şaraplar'
            },
            'c7': {
                title: 'Tatlıların Hikayesi',
                summary: 'Yemeğin en tatlı sonu... Usta ellerde hazırlanan, her biri mutluluk vadeden tatlılarımızla lezzet yolculuğunuzu taçlandırın.',
                fullStory: 'En güzel anlar tatlıyla biter. Çikolatanın yoğunluğundan meyvelerin ferahlığına, her bir tatlımız gününüzü güzelleştirmek için özenle hazırlanır. San Sebastian Cheesecakeimizin kremsi dokusundan, suflemizin akışkanlığına kadar her kaşıkta mutluluğu bulacaksınız.',
                image: 'https://placehold.co/600x400/333/fff?text=Tatlılar'
            },
            'c8': {
                title: 'Rakıların Hikayesi',
                summary: 'Anasonun ferahlığı ve asırlık bir geleneğin bilgeliği, her kadehte yeniden canlanıyor. Muhabbetin en güzel demine, en iyi rakılar eşlik eder.',
                fullStory: 'Rakı, sadece bir içki değil, bir kültürdür. Dost meclislerinin, derin sohbetlerin ve lezzetli mezelerin vazgeçilmezidir. Menümüzdeki her bir rakı, damıtım ustalığının ve anasonun en saf halinin birer temsilcisidir. Beyaz leblebi ve suyun eşliğinde, bu eşsiz geleneğin keyfini çıkarın.',
                image: 'https://placehold.co/600x400/333/fff?text=Rakılar'
            },
            'c9': {
                title: 'Biraların Hikayesi',
                summary: 'Dünyanın dört bir yanından getirdiğimiz, her damak zevkine uygun bira çeşitlerimizle serinleyin. Her yudumda kaliteyi ve ferahlığı hissedeceksiniz.',
                fullStory: 'Ferahlatıcı bir lagerden, yoğun aromalı bir ale’ye kadar, bira seçkimiz her anınıza eşlik etmek için hazırlandı. En kaliteli malt ve şerbetçiotları kullanılarak üretilen biralarımız, yemeğinizin yanında veya tek başına keyifli bir mola için mükemmel bir seçimdir.',
                image: 'https://placehold.co/600x400/333/fff?text=Biralar'
            },
            'c10': {
                title: 'Mezelerin Hikayesi',
                summary: 'Ege ve Akdeniz’in taptaze lezzetleri, modern bir yorumla sofranızda. Paylaşmanın keyfini, zengin meze çeşitlerimizle çıkarın.',
                fullStory: 'Meze, sadece bir başlangıç değil, aynı zamanda bir sofra kültürüdür. Zeytinyağlılarımızdan, yoğurtlu lezzetlerimize kadar her bir meze, en taze ve yerel malzemelerle hazırlanır. Dostlarla yapılan keyifli sohbetlerin en lezzetli eşlikçisi, zengin meze tabağımızdır.',
                image: 'https://placehold.co/600x400/333/fff?text=Mezeler'
            },
            'c11': {
                title: 'Shots\'ların Hikayesi',
                summary: 'Gecenin ritmini yükselten, cesur ve hızlı lezzetler. Tek bir yudumda unutulmaz anlar için... Şerefe!',
                fullStory: 'Bazen anı yakalamak için tek bir yudum yeterlidir. Klasik tekiladan, katmanlı B52\'ye kadar her bir shot, gecenize enerji katmak için özenle hazırlanır. Cesur lezzetler, unutulmaz anılar... Keyifli anların en hızlı yolu.',
                image: 'https://placehold.co/600x400/333/fff?text=Shots'
            }
          }
        };

        const allProducts = Object.values(menuData.products).flat();
        
        // --- Bileşenler (Components) ---

        const LoadingScreen = ({ isLoading }) => {
            return (
                <div className={`fixed inset-0 z-[9999] flex items-center justify-center bg-white transition-opacity duration-700 ease-in-out ${isLoading ? 'opacity-100' : 'opacity-0 pointer-events-none'}`}>
                    <div className="text-center">
                        <img 
                            src="./logo.png" 
                            alt="Logo Yükleniyor..." 
                            className="h-48 mb-8 mx-auto animate-pulse-scale"
                            onError={(e) => { e.target.style.display = 'none'; }}
                        />
                        <div className="w-16 h-16 border-4 border-gray-200 border-t-gray-800 rounded-full animate-spin mx-auto"></div>
                    </div>
                </div>
            );
        };

        const Header = ({ isSolid, onLogoClick }) => (
          <header 
            className={`fixed top-0 left-0 right-0 z-50 flex items-center justify-between px-4 py-1 max-w-md mx-auto h-[64px] transition-all duration-300 ease-in-out ${isSolid ? 'bg-white shadow-md' : 'bg-transparent'}`}>
            <button className={`p-2 transition-colors duration-300 ${isSolid ? 'text-gray-800' : 'text-white'}`}><MenuIcon /></button>
            <div className={`transition-opacity duration-300 cursor-pointer ${isSolid ? 'opacity-100' : 'opacity-0 pointer-events-none'}`} onClick={onLogoClick}>
                <img src="./logo.png" alt="SpicyMenu Logo" className="h-14" onError={(e) => { e.target.onerror = null; e.target.style.display='none'; document.getElementById('logo-text-header').style.display='block'; }} />
                <h1 id="logo-text-header" className={`hidden text-xl font-bold tracking-widest uppercase ${isSolid ? 'text-gray-900' : 'text-white'}`}>SpicyMenu</h1>
            </div>
            <button className={`p-2 transition-colors duration-300 ${isSolid ? 'text-gray-800' : 'text-white'}`}><SearchIcon /></button>
          </header>
        );
        
        const Hero = ({ onScrollClick, isScrolled }) => (
            <div className="relative h-screen w-full overflow-hidden">
                <video src="./hero.webm" autoPlay loop muted playsInline className="absolute top-0 left-0 w-full h-full object-cover z-0"></video>
                <div className="absolute top-0 left-0 w-full h-full bg-black/30 z-10"></div>
                <div className="relative z-20 flex flex-col items-center justify-center h-full px-4">
                    <img src="./logo.png" alt="SpicyMenu Logo" className={`h-56 mb-8 transition-opacity duration-300 ease-in-out drop-shadow-lg ${isScrolled ? 'opacity-0' : 'opacity-100'}`} onError={(e) => { e.target.style.display = 'none'; }} />
                    <button onClick={onScrollClick} className="font-regular text-white text-lg border border-white/80 rounded-full px-12 py-3 backdrop-blur-sm transition-colors hover:bg-white/20">Menüyü Görüntüle</button>
                </div>
            </div>
        );

        const CategoryCard = ({ category, onSelectCategory, isVisible, index }) => {
            const totalWidthInRow = category.row.reduce((acc, cat) => acc + cat.width, 0);
            const flexBasis = `${(category.width / totalWidthInRow) * 100}%`;
            return (
                <div className={`relative rounded-2xl p-6 flex flex-col justify-end cursor-pointer overflow-hidden text-white shadow-lg bg-gray-200 transition-all duration-700 ease-out ${isVisible ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-5'}`} style={{ flexBasis: flexBasis, aspectRatio: `${category.width}/${category.height}`, transitionDelay: `${index * 100}ms`}} onClick={() => onSelectCategory(category.id)}>
                    <video src={`./${category.media}.webm`} onError={(e) => e.target.style.display = 'none'} autoPlay loop muted playsInline className="absolute top-0 left-0 w-full h-full object-cover z-0"></video>
                    <img src={`./${category.media}.png`} alt={category.name} onError={(e) => e.target.style.display = 'none'} className="absolute top-0 left-0 w-full h-full object-cover z-0"/>
                    <div className="absolute top-0 left-0 w-full h-full bg-black/30 z-10"></div>
                    <div className="relative z-20">
                        <h2 className="text-2xl font-medium">{category.name}</h2>
                        <p className="text-sm font-regular opacity-90">{category.subtitle}</p>
                    </div>
                </div>
            );
        };

        const CategoryPage = ({ onSelectCategory, menuRef, isVisible }) => {
            let cardIndex = 0;
            return (
                <div ref={menuRef} className="p-4 flex flex-col gap-4 bg-gray-100" style={{ scrollMarginTop: '64px' }}>
                    {menuData.categoryRows.map((row, rowIndex) => (
                        <div key={rowIndex} className="flex gap-4">
                            {row.map(category => ( <CategoryCard key={category.id} category={{...category, row}} onSelectCategory={onSelectCategory} isVisible={isVisible} index={cardIndex++}/> ))}
                        </div>
                    ))}
                </div>
            );
        };

        const ProductListPage = ({ selectedCategory, onGoBack, onSelectCategory, onSelectProduct }) => {
          const products = menuData.products[selectedCategory] || [];
          const allCategories = menuData.categoryRows.flat();
          const activeCategory = allCategories.find(c => c.id === selectedCategory);
          const inactiveCategories = allCategories.filter(c => c.id !== selectedCategory);
          const sortedCategories = activeCategory ? [activeCategory, ...inactiveCategories] : allCategories;
          return (
            <div className="bg-gray-100 min-h-full pt-[64px]">
              <nav className="sticky top-[64px] z-30 bg-white overflow-x-auto whitespace-nowrap scroll-hidden w-full max-w-md">
                <div className="flex items-center p-4 border-b border-gray-200">
                    <button onClick={onGoBack} className="p-2 mr-2"><BackIcon className="h-6 w-6 text-gray-600"/></button>
                    {sortedCategories.map(cat => ( <button key={cat.id} onClick={() => onSelectCategory(cat.id)} className={`flex-shrink-0 px-3 py-2 text-sm transition-colors duration-300 ${selectedCategory === cat.id ? 'font-medium text-gray-900' : 'font-regular text-gray-500'}`}>{cat.name}</button> ))}
                </div>
              </nav>
              <div className="p-4 space-y-4">
                {products.length > 0 ? products.map(product => (
                  <div key={product.id} onClick={() => onSelectProduct(product)} className="flex items-center p-4 bg-white rounded-2xl cursor-pointer shadow-sm">
                    <div className="flex-1 pr-4">
                      <h3 className="text-lg font-medium text-gray-800">{product.name}</h3>
                      <p className="text-sm font-regular text-gray-600 mb-2">{product.description}</p>
                      <p className="text-md font-medium text-gray-900">{product.price}</p>
                    </div>
                    <img src={product.image} alt={product.name} className="w-28 h-28 rounded-lg object-cover" />
                  </div>
                )) : ( <div className="text-center py-16"><p className="text-gray-500">Bu kategoride henüz ürün bulunmuyor.</p></div> )}
              </div>
            </div>
          );
        };
        
        const ReelsCategoryPage = ({ selectedCategory, onGoBack, onSelectCategory, onSelectProduct, onSelectStory, story }) => {
            const products = menuData.products[selectedCategory] || [];
            const allCategories = menuData.categoryRows.flat();
            const activeCategory = allCategories.find(c => c.id === selectedCategory);
            const inactiveCategories = allCategories.filter(c => c.id !== selectedCategory);
            const sortedCategories = activeCategory ? [activeCategory, ...inactiveCategories] : allCategories;
            
            const reelsRef = React.useRef(null);
            const scrollIntervalRef = React.useRef(null);
            const [activeReelIndex, setActiveReelIndex] = React.useState(0);
            const isManualScrolling = React.useRef(false);
            const scrollEndTimer = React.useRef(null);

            const startScrolling = React.useCallback(() => {
                if (scrollIntervalRef.current || isManualScrolling.current) return;
                scrollIntervalRef.current = setInterval(() => {
                    if (reelsRef.current) {
                        const { scrollLeft, scrollWidth } = reelsRef.current;
                        if (scrollLeft >= (scrollWidth / 4) * 3) { 
                            reelsRef.current.style.scrollBehavior = 'auto';
                            reelsRef.current.scrollLeft = scrollLeft - (scrollWidth / 2);
                            reelsRef.current.style.scrollBehavior = 'smooth';
                        }
                        reelsRef.current.scrollLeft += 0.5;
                    }
                }, 25);
            }, []);

            const stopScrolling = React.useCallback(() => {
                clearInterval(scrollIntervalRef.current);
                scrollIntervalRef.current = null;
            }, []);

            const handleManualScrollStart = () => {
                isManualScrolling.current = true;
                stopScrolling();
                clearTimeout(scrollEndTimer.current);
            };

            const handleManualScrollEnd = () => {
                clearTimeout(scrollEndTimer.current);
                scrollEndTimer.current = setTimeout(() => {
                    isManualScrolling.current = false;
                    startScrolling();
                }, 2500); // Wait 2.5 seconds before resuming auto-scroll
            };

            React.useEffect(() => {
                startScrolling();
                return () => stopScrolling();
            }, [startScrolling, stopScrolling]);

            const handleScroll = React.useCallback(() => {
                if (!reelsRef.current) return;
                const container = reelsRef.current;
                const scrollLeft = container.scrollLeft;
                const itemWidth = container.children[0] ? container.children[0].offsetWidth + 16 : 0;
                
                if (itemWidth > 0) {
                    const firstItemIndex = Math.round(scrollLeft / itemWidth);
                    const newIndex = firstItemIndex + 1;
                    setActiveReelIndex(newIndex % products.length);
                }
            }, [products.length]);

            const throttledHandleScroll = React.useMemo(() => throttle(handleScroll, 50), [handleScroll]);

            React.useEffect(() => {
                const container = reelsRef.current;
                if (container) {
                    container.addEventListener('scroll', throttledHandleScroll, { passive: true });
                    throttledHandleScroll();
                }
                return () => { if (container) { container.removeEventListener('scroll', throttledHandleScroll); }};
            }, [throttledHandleScroll]);
            
            const duplicatedProducts = [...products, ...products, ...products, ...products];

            return (
                <div className="bg-gray-100 min-h-full pt-[64px]">
                    <nav className="sticky top-[64px] z-30 bg-white overflow-x-auto whitespace-nowrap scroll-hidden w-full max-w-md">
                        <div className="flex items-center p-4 border-b border-gray-200">
                            <button onClick={onGoBack} className="p-2 mr-2"><BackIcon className="h-6 w-6 text-gray-600"/></button>
                            {sortedCategories.map(cat => (<button key={cat.id} onClick={() => onSelectCategory(cat.id)} className={`flex-shrink-0 px-3 py-2 text-sm transition-colors duration-300 ${selectedCategory === cat.id ? 'font-medium text-gray-900' : 'font-regular text-gray-500'}`}>{cat.name}</button>))}
                        </div>
                    </nav>

                    <div>
                        <div ref={reelsRef} onMouseDown={handleManualScrollStart} onTouchStart={handleManualScrollStart} onMouseUp={handleManualScrollEnd} onTouchEnd={handleManualScrollEnd} onMouseLeave={handleManualScrollEnd} className="flex overflow-x-auto scroll-hidden px-4 py-8 space-x-4 items-center cursor-grab active:cursor-grabbing" style={{ scrollSnapType: 'x mandatory' }}>
                            {duplicatedProducts.map((product, index) => (
                                <div key={`${product.id}-${index}`} className={`flex-shrink-0 w-32 text-center transition-transform duration-300 ease-in-out`} style={{ scrollSnapAlign: 'center' }} onClick={() => onSelectProduct(product)}>
                                    <div className={`relative w-full h-48 rounded-2xl overflow-hidden shadow-lg transform transition-transform duration-300 ease-in-out ${activeReelIndex === index % products.length ? 'scale-110' : 'scale-100'}`}>
                                         <video src={`./${product.video}.webm`} autoPlay loop muted playsInline className="absolute top-0 left-0 w-full h-full object-cover z-0"></video>
                                         <div className="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent"></div>
                                         <div className="absolute bottom-0 left-0 p-3 text-white">
                                            <h3 className="font-medium text-sm">{product.name}</h3>
                                            <p className="text-xs font-regular">{product.price}</p>
                                         </div>
                                    </div>
                                </div>
                            ))}
                        </div>

                        {story && (
                            <div className="p-4 pt-0">
                                <div className="bg-white rounded-2xl p-6 shadow-sm">
                                    <h3 className="text-xl font-medium text-gray-800">{story.title}</h3>
                                    <p className="text-gray-600 mt-2 font-regular">{story.summary}</p>
                                    <button onClick={() => onSelectStory(story)} className="mt-4 text-sm font-medium text-gray-800 border border-gray-400 rounded-full px-5 py-2 hover:bg-gray-100 transition-colors">KEŞFET</button>
                                </div>
                            </div>
                        )}

                        <div className="p-4 space-y-4">
                            {products.map(product => (
                                <div key={product.id} onClick={() => onSelectProduct(product)} className="flex items-center p-4 bg-white rounded-2xl cursor-pointer shadow-sm">
                                    <div className="flex-1 pr-4">
                                        <h3 className="text-lg font-medium text-gray-800">{product.name}</h3>
                                        <p className="text-sm font-regular text-gray-600 mb-2">{product.description}</p>
                                        <p className="text-md font-medium text-gray-900">{product.price}</p>
                                    </div>
                                    <div className="w-28 h-28 rounded-lg object-cover overflow-hidden flex-shrink-0 bg-gray-200">
                                        <video src={`./${product.video}.webm`} autoPlay loop muted playsInline className="w-full h-full object-cover" onError={(e) => e.target.style.display='none'}></video>
                                        <img src={product.image} alt={product.name} className="w-full h-full object-cover" onError={(e) => e.target.style.display='none'}/>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            );
        };
        
        const ProductDetailPage = ({ product, onGoBack }) => {
            if (!product) return null;
            const getRecommendations = (p) => {
                if (!p.tags) return [];
                let recommendations = [];
                if (p.tags.includes('kirmizi-et') && !p.tags.includes('burger')) { recommendations = allProducts.filter(item => item.tags && item.tags.includes('sarap')); } 
                else if (p.tags.includes('balik') || p.tags.includes('tavuk')) { recommendations = allProducts.filter(item => item.tags && item.tags.includes('salata')); } 
                else if (p.tags.includes('pizza') || p.tags.includes('burger')) { recommendations = allProducts.filter(item => item.tags && item.tags.includes('kola'));}
                return recommendations.slice(0, 2);
            };
            const recommendations = getRecommendations(product);
            return (
                <div className="bg-gray-100 min-h-full" style={{ WebkitOverflowScrolling: 'touch' }}>
                    <div className="relative h-[30rem] overflow-hidden rounded-b-3xl bg-gray-200">
                        {product.video ? (<video src={`./${product.video}.webm`} autoPlay loop muted playsInline className="absolute top-0 left-0 w-full h-full object-cover"></video>) : (<img src={product.image} alt={product.name} className="absolute top-0 left-0 w-full h-full object-cover" />)}
                         <button onClick={onGoBack} className="absolute top-4 left-4 bg-white/80 p-2 rounded-full shadow-md z-30"><BackIcon className="h-6 w-6 text-gray-800" /></button>
                    </div>
                    <div className="p-6">
                        <div className="flex justify-between items-start mb-4">
                            <div><h2 className="text-3xl font-medium text-gray-900">{product.name}</h2><p className="text-md font-regular text-gray-600">{product.description}</p></div>
                            <p className="text-2xl font-medium text-gray-900 whitespace-nowrap ml-4">{product.price}</p>
                        </div>
                        <div className="flex justify-around bg-white p-4 rounded-2xl shadow-sm text-center text-gray-600">
                            <div className="flex flex-col items-center"><ClockIcon /> <span className="font-medium">{product.prepTime}</span> dakika</div>
                            <div className="flex flex-col items-center"><WeightIcon /> <span className="font-medium">{product.grams}</span> gram</div>
                            <div className="flex flex-col items-center"><FireIcon /> <span className="font-medium">{product.kcal}</span> kcal</div>
                        </div>
                        {recommendations.length > 0 && (
                            <div className="mt-8">
                                <h3 className="text-xl font-medium text-gray-800 mb-4">Birlikte İyi Gider</h3>
                                <div className="space-y-4">
                                    {recommendations.map(rec => (
                                        <div key={rec.id} className="flex items-center p-4 bg-white rounded-2xl shadow-sm">
                                            <img src={rec.image} alt={rec.name} className="w-16 h-16 rounded-lg object-cover mr-4" />
                                            <div className="flex-1"><h4 className="font-medium text-gray-800">{rec.name}</h4><p className="text-sm text-gray-500">{rec.price}</p></div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        };
        
        const StoryPage = ({ story, onGoBack }) => {
            if (!story) return null;
            return (
                <div className="bg-white min-h-full">
                    <div className="relative h-72">
                        <img src={story.image} alt={story.title} className="absolute top-0 left-0 w-full h-full object-cover" />
                        <div className="absolute inset-0 bg-gradient-to-t from-black/50 to-transparent"></div>
                        <button onClick={onGoBack} className="absolute top-4 left-4 bg-white/80 p-2 rounded-full shadow-md z-10"><BackIcon className="h-6 w-6 text-gray-800" /></button>
                        <h2 className="absolute bottom-6 left-6 text-4xl font-semibold text-white">{story.title}</h2>
                    </div>
                    <div className="p-6">
                        <p className="text-gray-700 font-regular whitespace-pre-line leading-relaxed">{story.fullStory}</p>
                    </div>
                </div>
            );
        };

        const preloadAsset = (src) => {
          return new Promise((resolve) => {
            const isVideo = src.endsWith('.webm');
            const element = isVideo ? document.createElement('video') : document.createElement('img');
            element.src = src;
            const onAssetLoad = () => resolve(src);
            if (isVideo) {
                element.oncanplaythrough = onAssetLoad;
            } else {
                element.onload = onAssetLoad;
            }
            element.onerror = onAssetLoad;
          });
        };

        function App() {
          const [page, setPage] = React.useState('categories');
          const [selectedCategory, setSelectedCategory] = React.useState(null);
          const [selectedProduct, setSelectedProduct] = React.useState(null);
          const [selectedStory, setSelectedStory] = React.useState(null);
          const [isHeaderSolid, setIsHeaderSolid] = React.useState(false);
          const [isMenuVisible, setIsMenuVisible] = React.useState(false);
          const [isLoading, setIsLoading] = React.useState(true);
          const menuRef = React.useRef(null);
          const scrollContainerRef = React.useRef(null);

          React.useEffect(() => {
            const assetsToPreload = menuData.categoryRows
              .flat()
              .flatMap(category => [`./${category.media}.webm`, `./${category.media}.png`]);

            const preloadPromises = assetsToPreload.map(preloadAsset);
            const minimumLoaderTime = new Promise(resolve => setTimeout(resolve, 2000));

            Promise.all([...preloadPromises, minimumLoaderTime]).then(() => {
              console.log("Tüm kritik medya dosyaları yüklendi.");
              setIsLoading(false);
            });
          }, []);

          React.useEffect(() => {
            const handlePopState = (event) => {
              if (event.state && event.state.page) {
                setPage(event.state.page);
                setSelectedCategory(event.state.category);
                setSelectedProduct(event.state.product);
                setSelectedStory(event.state.story);
              } else {
                setPage('categories');
              }
            };
            window.addEventListener('popstate', handlePopState);
            window.history.replaceState({ page: 'categories', category: null, product: null, story: null }, '');
            return () => { window.removeEventListener('popstate', handlePopState); };
          }, []);

          React.useEffect(() => {
            const container = scrollContainerRef.current;
            if (!container) return;
            const handleScroll = () => {
              setIsHeaderSolid(container.scrollTop > 50);
              if (menuRef.current && !isMenuVisible) {
                if (menuRef.current.getBoundingClientRect().top < window.innerHeight * 0.85) { setIsMenuVisible(true); }
              }
            };
            container.addEventListener('scroll', handleScroll, { passive: true });
            return () => container.removeEventListener('scroll', handleScroll);
          }, [isMenuVisible]);

          const handleLogoClick = () => {
              setPage('categories');
              window.history.pushState({ page: 'categories' }, '');
              setTimeout(() => { scrollContainerRef.current?.scrollTo({ top: 0, behavior: 'smooth' }); }, 50);
          };
          const handleScrollToMenu = () => {
            menuRef.current?.scrollIntoView({ behavior: 'smooth' });
            setTimeout(() => setIsMenuVisible(true), 100);
          };
          const handleSelectCategory = (categoryId) => { 
              setSelectedCategory(categoryId);
              setPage('products');
              window.history.pushState({ page: 'products', category: categoryId }, '');
          };
          const handleSelectProduct = (product) => { 
              setSelectedProduct(product);
              setPage('productDetail');
              window.history.pushState({ page: 'productDetail', category: selectedCategory, product }, '');
          };
          const handleSelectStory = (story) => {
              setSelectedStory(story);
              setPage('story');
              window.history.pushState({ page: 'story', story }, '');
          };
          const goBack = () => window.history.back();

          const getPageTransform = () => {
            if (page === 'products') return '-translate-x-full';
            if (page === 'productDetail') return '-translate-x-[200%]';
            if (page === 'story') return '-translate-x-[300%]';
            return 'translate-x-0';
          };
          
          const ProductPage = () => {
              if (!selectedCategory) return null;
              
              const story = menuData.stories[selectedCategory];
              const products = menuData.products[selectedCategory] || [];
              
              if (products.length > 0) {
                  return <ReelsCategoryPage 
                            selectedCategory={selectedCategory} 
                            onGoBack={goBack} 
                            onSelectCategory={handleSelectCategory} 
                            onSelectProduct={handleSelectProduct} 
                            onSelectStory={handleSelectStory} 
                            story={story}
                         />;
              }
              return <ProductListPage 
                          selectedCategory={selectedCategory} 
                          onGoBack={goBack} 
                          onSelectCategory={handleSelectCategory} 
                          onSelectProduct={handleSelectProduct} 
                       />;
          };

          return (
              <div className="bg-gray-100 min-h-screen max-w-md mx-auto">
                  <LoadingScreen isLoading={isLoading} />
                  
                  {!isLoading && (
                      <>
                          {(page !== 'productDetail' && page !== 'story') && <Header isSolid={isHeaderSolid || page !== 'categories'} onLogoClick={handleLogoClick} />}
                          <main className="relative w-full h-screen overflow-hidden">
                            <div className={`flex transition-transform duration-500 ease-in-out h-full ${getPageTransform()}`}>
                              
                              <div ref={scrollContainerRef} className="w-full flex-shrink-0 h-full overflow-y-auto scroll-hidden bg-white">
                                  <Hero onScrollClick={handleScrollToMenu} isScrolled={isHeaderSolid} />
                                  <CategoryPage onSelectCategory={handleSelectCategory} menuRef={menuRef} isVisible={isMenuVisible} />
                              </div>

                              <div className="w-full flex-shrink-0 h-full overflow-y-auto scroll-hidden">
                                <ProductPage />
                              </div>
                              
                              <div className="w-full flex-shrink-0 h-full overflow-y-auto" style={{ WebkitOverflowScrolling: 'touch' }}>
                                <ProductDetailPage product={selectedProduct} onGoBack={goBack} />
                              </div>
                              
                              <div className="w-full flex-shrink-0 h-full overflow-y-auto scroll-hidden">
                                  <StoryPage story={selectedStory} onGoBack={goBack} />
                              </div>

                            </div>
                          </main>
                      </>
                  )}
              </div>
          );
        }

        const container = document.getElementById('root');
        const root = ReactDOM.createRoot(container);
        root.render(<App />);
    </script>
</body>
</html>
