import React, { useState } from 'react';

// --- Ikonlar (SVG olarak) ---
const MenuIcon = () => (
  <svg xmlns="http://www.w3.org/2000/svg" className="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}>
    <path strokeLinecap="round" strokeLinejoin="round" d="M4 6h16M4 12h16m-16 6h16" />
  </svg>
);

const SearchIcon = () => (
  <svg xmlns="http://www.w3.org/2000/svg" className="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}>
    <path strokeLinecap="round" strokeLinejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
  </svg>
);

const BackIcon = () => (
    <svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}>
        <path strokeLinecap="round" strokeLinejoin="round" d="M15 19l-7-7 7-7" />
    </svg>
);

// --- Örnek Menü Verisi ---
// Veri yapısı, her bir sırayı ayrı bir dizi olarak tutacak şekilde güncellendi.
// Yükseklikler, görseldeki tasarıma uyması için değiştirildi.
const menuData = {
  categoryRows: [
    [
      { id: 'c1', name: 'Title1', subtitle: 'Subtitle1', width: 170, height: 200 },
      { id: 'c2', name: 'Title2', subtitle: 'Subtitle2', width: 170, height: 200 }
    ],
    [
      { id: 'c3', name: 'Title3', subtitle: 'Subtitle3', width: 205, height: 250 }, // Görseldeki gibi daha uzun
      { id: 'c4', name: 'Title4', subtitle: 'Subtitle4', width: 135, height: 200 }
    ],
    [
      { id: 'c5', name: 'Title5', subtitle: 'Subtitle5', width: 360, height: 200 }
    ],
    [
      { id: 'c6', name: 'Title6', subtitle: 'Subtitle6', width: 205, height: 250 }, // Görseldeki gibi daha uzun
      { id: 'c7', name: 'Title7', subtitle: 'Subtitle7', width: 135, height: 200 }
    ],
    [
      { id: 'c8', name: 'Title8', subtitle: 'Subtitle8', width: 170, height: 200 },
      { id: 'c9', name: 'Title9', subtitle: 'Subtitle9', width: 170, height: 200 }
    ]
  ],
  products: {
    'c1': [ { id: 'p1', name: 'Product 1', description: 'Lezzetli ürün açıklaması.', price: '165 TL', image: 'https://placehold.co/100x100/e9e9e9/333?text=P1' } ],
    'c2': [ { id: 'p2', name: 'Product 2', description: 'Lezzetli ürün açıklaması.', price: '190 TL', image: 'https://placehold.co/100x100/e9e9e9/333?text=P2' } ],
    'c3': [ { id: 'p3', name: 'Product 3', description: 'Lezzetli ürün açıklaması.', price: '250 TL', image: 'https://placehold.co/100x100/e9e9e9/333?text=P3' } ],
    'c4': [ { id: 'p4', name: 'Product 4', description: 'Lezzetli ürün açıklaması.', price: '220 TL', image: 'https://placehold.co/100x100/e9e9e9/333?text=P4' } ],
    'c5': [ { id: 'p5', name: 'Product 5', description: 'Lezzetli ürün açıklaması.', price: '240 TL', image: 'https://placehold.co/100x100/e9e9e9/333?text=P5' } ],
    'c6': [ { id: 'p6', name: 'Product 6', description: 'Lezzetli ürün açıklaması.', price: '210 TL', image: 'https://placehold.co/100x100/e9e9e9/333?text=P6' } ],
    'c7': [ { id: 'p7', name: 'Product 7', description: 'Lezzetli ürün açıklaması.', price: '180 TL', image: 'https://placehold.co/100x100/e9e9e9/333?text=P7' } ],
    'c8': [ { id: 'p8', name: 'Product 8', description: 'Lezzetli ürün açıklaması.', price: '150 TL', image: 'https://placehold.co/100x100/e9e9e9/333?text=P8' } ],
    'c9': [ { id: 'p9', name: 'Product 9', description: 'Lezzetli ürün açıklaması.', price: '175 TL', image: 'https://placehold.co/100x100/e9e9e9/333?text=P9' } ],
  }
};

// --- Bileşenler (Components) ---

const Header = () => (
  <header className="sticky top-0 z-50 flex items-center justify-between px-4 py-4 bg-white/80 backdrop-blur-md shadow-sm">
    <button className="p-2 text-gray-800"><MenuIcon /></button>
    <h1 className="text-xl font-bold tracking-widest text-gray-900 uppercase">SpicyMenu</h1>
    <button className="p-2 text-gray-800"><SearchIcon /></button>
  </header>
);

// Kategori Sayfası - TASARIMA GÖRE GÜNCELLENDİ
const CategoryPage = ({ onSelectCategory }) => {
    return (
        <div className="p-4 flex flex-col gap-4">
            {menuData.categoryRows.map((row, rowIndex) => {
                // Sıradaki toplam genişliği hesapla (boşluklar hariç)
                const totalWidthInRow = row.reduce((acc, cat) => acc + cat.width, 0);

                return (
                    <div key={rowIndex} className="flex gap-4">
                        {row.map(category => {
                            // Kartın esnek genişliğini yüzde olarak hesapla
                            const flexBasis = `${(category.width / totalWidthInRow) * 100}%`;
                            
                            return (
                                <div
                                    key={category.id}
                                    className="bg-gray-200 rounded-2xl p-6 flex flex-col justify-end cursor-pointer transition-transform duration-300 hover:scale-[1.03]"
                                    style={{ 
                                        flexBasis: flexBasis,
                                        aspectRatio: `${category.width} / ${category.height}`
                                    }}
                                    onClick={() => onSelectCategory(category.id)}
                                >
                                    <h2 className="text-2xl font-bold text-gray-800">{category.name}</h2>
                                    <p className="text-gray-600">{category.subtitle}</p>
                                </div>
                            );
                        })}
                    </div>
                );
            })}
        </div>
    );
};

const ProductListPage = ({ selectedCategory, onGoBack, onSelectCategory }) => {
  const products = menuData.products[selectedCategory] || [];
  const allCategories = menuData.categoryRows.flat();
  
  return (
    <div>
      <nav className="sticky top-[72px] z-40 bg-white/80 backdrop-blur-md overflow-x-auto whitespace-nowrap">
        <div className="flex p-4 border-b border-gray-200">
            <button onClick={onGoBack} className="flex-shrink-0 flex items-center justify-center px-4 py-2 text-sm font-semibold text-gray-700 bg-gray-200 rounded-full">
                <BackIcon/> Kategoriler
            </button>
            <div className="w-4 flex-shrink-0"></div>
            {allCategories.map(cat => (
                 <button 
                    key={cat.id}
                    onClick={() => onSelectCategory(cat.id)}
                    className={`flex-shrink-0 px-5 py-2 text-sm font-semibold rounded-full transition-colors duration-300 mr-2
                        ${selectedCategory === cat.id ? 'bg-gray-900 text-white' : 'bg-gray-200 text-gray-700'}`}
                >
                    {cat.name}
                </button>
            ))}
        </div>
      </nav>
      <div className="p-4 space-y-4">
        {products.length > 0 ? products.map(product => (
          <div key={product.id} className="flex items-center p-4 bg-gray-200 rounded-2xl cursor-pointer">
            <div className="flex-1 pr-4">
              <h3 className="text-lg font-bold text-gray-800">{product.name}</h3>
              <p className="text-sm text-gray-600 mb-2">{product.description}</p>
              <p className="text-md font-bold text-gray-900">{product.price}</p>
            </div>
            <img src={product.image} alt={product.name} className="w-28 h-28 rounded-lg object-cover" />
          </div>
        )) : (
            <div className="text-center py-16">
                <p className="text-gray-500">Bu kategoride henüz ürün bulunmuyor.</p>
            </div>
        )}
      </div>
    </div>
  );
};


// Ana Uygulama Bileşeni
export default function App() {
  const [page, setPage] = useState('categories');
  const [selectedCategory, setSelectedCategory] = useState(null);

  const handleSelectCategory = (categoryId) => {
    setSelectedCategory(categoryId);
    setPage('products');
  };

  const handleGoBack = () => {
    setPage('categories');
  };

  const handleChangeCategory = (categoryId) => {
      setSelectedCategory(categoryId);
  }

  return (
    <div className="font-sans bg-gray-100 min-h-screen max-w-md mx-auto border-x border-gray-200">
      <Header />
      <main className="relative overflow-x-hidden">
        <div className={`transform transition-transform duration-500 ease-in-out ${page === 'categories' ? 'translate-x-0' : '-translate-x-full'}`}>
            <CategoryPage onSelectCategory={handleSelectCategory} />
        </div>
        <div className={`absolute top-0 left-0 w-full transform transition-transform duration-500 ease-in-out ${page === 'products' ? 'translate-x-0' : 'translate-x-full'}`}>
            {selectedCategory && <ProductListPage selectedCategory={selectedCategory} onGoBack={handleGoBack} onSelectCategory={handleChangeCategory} />}
        </div>
      </main>
      
      <style>{`
        nav::-webkit-scrollbar { display: none; }
        nav { -ms-overflow-style: none; scrollbar-width: none; }
      `}</style>
    </div>
  );
}
